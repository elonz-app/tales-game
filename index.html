<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Tales - Truth Awaits</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0f1e, #1a1f2f);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
        }

        .game-container {
            background: rgba(10, 15, 30, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid #00ffff;
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.3);
            border-radius: 30px;
            padding: 40px;
            width: 90%;
            max-width: 800px;
            min-height: 600px;
            position: relative;
            overflow: hidden;
        }

        .game-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
            z-index: -1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Connection Status */
        .connection-status {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 100;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .connected .status-dot {
            background: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }

        .disconnected .status-dot {
            background: #ff0000;
            box-shadow: 0 0 10px #ff0000;
        }

        /* Intricate Logo */
        .logo-container {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            perspective: 1000px;
        }

        .intricate-logo {
            font-size: 6rem;
            font-weight: 900;
            position: relative;
            display: inline-block;
            padding: 20px 50px;
            background: linear-gradient(135deg, #00ffff, #ff00ff, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
            letter-spacing: 15px;
            border: 3px solid transparent;
            border-image: linear-gradient(45deg, #00ffff, #ff00ff);
            border-image-slice: 1;
            border-radius: 20px;
            transform-style: preserve-3d;
            animation: float3d 6s infinite ease-in-out;
        }

        .intricate-logo::before {
            content: '‚ö°';
            position: absolute;
            left: -20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 3rem;
            color: #00ffff;
            filter: drop-shadow(0 0 10px #ff00ff);
            animation: pulse 2s infinite;
        }

        .intricate-logo::after {
            content: '‚ö°';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 3rem;
            color: #ff00ff;
            filter: drop-shadow(0 0 10px #00ffff);
            animation: pulse 2s infinite reverse;
        }

        @keyframes float3d {
            0%, 100% { transform: rotateY(0deg) translateZ(0); }
            50% { transform: rotateY(10deg) translateZ(20px); }
        }

        /* Circular Loader */
        .circular-loader {
            width: 200px;
            height: 200px;
            margin: 40px auto;
            position: relative;
        }

        .loader-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 10px solid rgba(255, 255, 255, 0.1);
            border-top-color: #00ffff;
            border-right-color: #ff00ff;
            border-bottom-color: #00ffff;
            border-left-color: #ff00ff;
            animation: spin 2s linear infinite;
        }

        .loader-progress {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 20px #00ffff;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Login Form */
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .input-group {
            position: relative;
        }

        .input-group input {
            width: 100%;
            padding: 18px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #00ffff;
            border-radius: 15px;
            color: #fff;
            font-size: 1rem;
            outline: none;
            transition: 0.3s;
        }

        .input-group input:focus {
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
            border-color: #ff00ff;
        }

        .input-group label {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
            pointer-events: none;
            transition: 0.3s;
            background: #1a1f2f;
            padding: 0 5px;
        }

        .input-group input:focus ~ label,
        .input-group input:valid ~ label {
            top: -10px;
            font-size: 0.8rem;
            color: #00ffff;
        }

        .btn {
            padding: 18px;
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            border: none;
            border-radius: 15px;
            color: #fff;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
            text-transform: uppercase;
            letter-spacing: 3px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 0, 255, 0.5);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Game Sections */
        .game-section {
            display: none;
        }

        .game-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Typing Indicator */
        .typing-indicator {
            display: none;
            padding: 15px;
            background: rgba(0, 255, 255, 0.1);
            border-radius: 15px;
            margin: 10px 0;
        }

        .typing-indicator.active {
            display: flex;
            gap: 5px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #00ffff;
            border-radius: 50%;
            animation: typingBounce 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingBounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        /* Gift Popup */
        .gift-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #00ffff, #ff00ff);
            padding: 40px;
            border-radius: 50%;
            box-shadow: 0 0 100px rgba(255, 0, 255, 0.8);
            z-index: 2000;
            animation: giftAppear 0.5s forwards;
            text-align: center;
        }

        @keyframes giftAppear {
            to { transform: translate(-50%, -50%) scale(1); }
        }

        .gift-popup .gift-icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }

        .gift-popup .gift-close {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: #fff;
        }

        /* Clue Container */
        .clue-container {
            margin: 30px 0;
            padding: 25px;
            background: rgba(0, 255, 255, 0.05);
            border-left: 4px solid #00ffff;
            border-right: 4px solid #ff00ff;
            border-radius: 20px;
        }

        .clue-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #00ffff;
            text-shadow: 0 0 10px #ff00ff;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .option-btn {
            padding: 18px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #00ffff;
            border-radius: 15px;
            color: #fff;
            cursor: pointer;
            transition: 0.3s;
            font-size: 1.1rem;
        }

        .option-btn:hover:not(:disabled) {
            background: rgba(0, 255, 255, 0.2);
            border-color: #ff00ff;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.3);
        }

        .host-response {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 0, 255, 0.1);
            border-radius: 15px;
            border: 1px solid #ff00ff;
            line-height: 1.6;
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px #ff00ff; }
            50% { box-shadow: 0 0 20px #00ffff; }
        }

        .question-section {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 15px;
        }

        .question-input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #ff00ff;
            border-radius: 10px;
            color: #fff;
            font-size: 1rem;
        }

        .ask-btn {
            padding: 12px 25px;
            background: transparent;
            border: 2px solid #00ffff;
            color: #00ffff;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.3s;
            margin-right: 10px;
        }

        .ask-btn:hover:not(:disabled) {
            background: #00ffff;
            color: #000;
        }

        .popup {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            padding: 20px 40px;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 0 40px rgba(255, 0, 255, 0.6);
            animation: slideDown 0.5s ease-out;
            z-index: 1000;
        }

        @keyframes slideDown {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }
    </style>
    <!-- Socket.IO client -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="game-container" id="gameContainer">
        <!-- Connection Status -->
        <div id="connectionStatus" class="connection-status disconnected">
            <span class="status-dot"></span>
            <span id="statusText">Connecting...</span>
        </div>

        <!-- Login Page -->
        <div id="loginPage" class="game-section active">
            <div class="logo-container">
                <div class="intricate-logo">A&B</div>
                <p style="color: #00ffff; margin-top: 20px; letter-spacing: 3px;">THE TRUTH AWAITS</p>
            </div>
            
            <div class="login-form">
                <div class="input-group">
                    <input type="text" id="username" required>
                    <label>Username</label>
                </div>
                <div class="input-group">
                    <input type="password" id="password" required>
                    <label>Password</label>
                </div>
                <button class="btn" onclick="login()" id="loginBtn">ENTER THE UNKNOWN</button>
                <div id="loginError" class="error-message" style="color: #ff00ff; text-align: center;"></div>
            </div>
        </div>

        <!-- Loading Page -->
        <div id="loadingPage" class="game-section">
            <div class="logo-container">
                <div class="intricate-logo">A&B</div>
            </div>
            
            <div class="circular-loader">
                <div class="loader-circle"></div>
                <div class="loader-progress" id="loaderProgress">0%</div>
            </div>
            <p id="loaderText" style="text-align: center; color: #00ffff;">Initializing...</p>
        </div>

        <!-- Introduction Page -->
        <div id="introPage" class="game-section">
            <div class="clue-container">
                <h2 class="clue-title">üß† THE MIND GAME</h2>
                <div class="story-text" style="font-size: 1.2rem; text-align: center;">
                    <p style="margin-bottom: 20px;">This is not just a game...</p>
                    <p>It's a journey into the depths of your consciousness.</p>
                    <p style="color: #00ffff; margin: 20px 0;">"The truth to most of your unanswered questions lies within."</p>
                    <p>Every choice you make, every path you take,</p>
                    <p>will reveal a piece of the puzzle you've been seeking.</p>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <p style="margin-bottom: 20px; color: #ff00ff;">Do you wish to continue?</p>
                    <button class="btn" onclick="startFirstClue()" style="margin-right: 20px; padding: 15px 40px;">YES</button>
                    <button class="btn" onclick="restartGame()" style="background: transparent; border: 2px solid #ff00ff;">NO</button>
                </div>
            </div>
        </div>

        <!-- Main Game Content -->
        <div id="gamePage" class="game-section">
            <div class="logo-container">
                <div class="intricate-logo" style="font-size: 4rem;">TALES</div>
            </div>
            
            <!-- Clue 1 -->
            <div id="clue1" class="clue-container">
                <h2 class="clue-title">üîç FIRST CLUE</h2>
                <p style="margin-bottom: 20px;">If a guy [James] is to call you late at night and your mum picks the phone instead & asks "yes James where do you come from"</p>
                <p><strong>What will be James' answer?</strong></p>
                
                <div class="options">
                    <button class="option-btn" onclick="checkAnswer1('A')" id="optA">A. Kireka</button>
                    <button class="option-btn" onclick="checkAnswer1('B')" id="optB">B. Mukono</button>
                    <button class="option-btn" onclick="checkAnswer1('C')" id="optC">C. Nansana</button>
                    <button class="option-btn" onclick="checkAnswer1('D')" id="optD">D. Kyengera</button>
                </div>
            </div>

            <!-- Clue 2 -->
            <div id="clue2" style="display: none;" class="clue-container">
                <h2 class="clue-title">üîç SECOND CLUE</h2>
                <p style="margin-bottom: 20px;">From the first clue you must now be in position to know who James is</p>
                <p><strong>Having overheard James on a phone call with your mum, who is James to you now?</strong></p>
                
                <div class="options">
                    <button class="option-btn" onclick="checkAnswer2('A')">A. Znob</button>
                    <button class="option-btn" onclick="checkAnswer2('B')">B. üò£</button>
                    <button class="option-btn" onclick="checkAnswer2('C')">C. Ask a QN instead</button>
                    <button class="option-btn" onclick="checkAnswer2('D')">D. Still don't know</button>
                </div>

                <div id="customQuestion" class="hidden-input" style="display: none;">
                    <h3 style="color: #ff00ff; margin-bottom: 15px;">Ask Your Question:</h3>
                    <input type="text" id="customQuestionInput" class="question-input" placeholder="Type your question here...">
                    <input type="text" id="customAnswerInput" class="question-input" placeholder="Your expected answer...">
                    <button class="btn" onclick="askCustomQuestion()" style="padding: 12px;">ASK THE HOST</button>
                </div>

                <div id="decodeSection" class="hidden-input" style="display: none;">
                    <h3 style="color: #00ffff; margin-bottom: 15px;">Decode the message:</h3>
                    <input type="text" id="decodeInput" class="question-input" placeholder="Enter decoded word...">
                    <button class="btn" onclick="decodeAnswer()" style="padding: 12px;">SUBMIT</button>
                </div>

                <!-- Typing Indicator -->
                <div id="typingIndicator" class="typing-indicator">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <span style="margin-left: 10px; color: #00ffff;">Host is typing...</span>
                </div>

                <!-- Host Response Container -->
                <div id="hostResponse" class="host-response" style="display: none;"></div>
            </div>

            <!-- Clue 3 - The Piece of Truth -->
            <div id="clue3" style="display: none;" class="clue-container">
                <h2 class="clue-title">üìú THE PIECE OF TRUTH</h2>
                <div class="story-text">
                    <p>In the world of espionage, -oo7 (aka 007) and A' (aka Via) were an unstoppable couple. Their love was the stuff of legends, with -oo7 smiling only for A'. But as time went by, gaps crept in, and the distance between them grew. Despite -oo7's unwavering love, the pressures of their secret lives took a toll.</p>
                    
                    <p>The truth that emerged from the shadows was that some love stories aren't meant to last forever. They become legends, whispered in the corridors of time, reminding us that even the strongest bonds can be tested by the weight of secrets and the price of duty.</p>
                    
                    <p>A' and -oo7's tale teaches us that sometimes, the greatest truth is that love and loss are two sides of the same coin. In the end, what remains is not the pain of separation, but the beauty of having loved deeply in a world that rarely allows it.</p>
                    
                    <p style="color: #00ffff; text-align: center; margin-top: 20px;">"In every ending lies a new beginning."</p>
                </div>

                <!-- Question Section -->
                <div class="question-section">
                    <h3 style="color: #ff00ff; margin-bottom: 20px;">ASK YOUR OWN QUESTIONS</h3>
                    <input type="text" id="guestQuestion" class="question-input" placeholder="What would you like to know?">
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="ask-btn" onclick="askHostQuestion()" id="askHostBtn">ASK THE HOST</button>
                        <button class="ask-btn" onclick="restartGame()" style="border-color: #ff00ff; color: #ff00ff;">PLAY AGAIN</button>
                    </div>
                    
                    <!-- Typing Indicator for Clue 3 -->
                    <div id="typingIndicator3" class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <span style="margin-left: 10px; color: #00ffff;">Host is typing...</span>
                    </div>
                    
                    <div id="hostAnswer" class="host-response" style="display: none; margin-top: 20px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gift Popup Container -->
    <div id="giftPopup" style="display: none;"></div>

    <script>
        // Configuration
        const BACKEND_URL = 'https://your-backend-url.railway.app'; // Replace with your Railway URL
        const SOCKET_URL = 'https://your-backend-url.railway.app'; // Same as backend URL
        
        // Socket.IO connection
        let socket;
        let sessionId = localStorage.getItem('sessionId') || 'session_' + Date.now();
        let connected = false;
        
        // Initialize Socket connection
        function initSocket() {
            socket = io(SOCKET_URL, {
                transports: ['websocket'],
                reconnection: true,
                reconnectionAttempts: 5
            });
            
            socket.on('connect', () => {
                console.log('Connected to server');
                updateConnectionStatus(true);
                socket.emit('join-game', sessionId);
            });
            
            socket.on('disconnect', () => {
                console.log('Disconnected from server');
                updateConnectionStatus(false);
            });
            
            socket.on('connect_error', (error) => {
                console.log('Connection error:', error);
                updateConnectionStatus(false);
            });
            
            socket.on('host-message', (data) => {
                showHostMessage(data.message);
            });
            
            socket.on('host-response', (data) => {
                document.getElementById('typingIndicator').classList.remove('active');
                document.getElementById('typingIndicator3').classList.remove('active');
                displayHostResponse(data.response);
            });
            
            socket.on('host-typing', (data) => {
                if (data.typing) {
                    document.getElementById('typingIndicator').classList.add('active');
                    document.getElementById('typingIndicator3').classList.add('active');
                } else {
                    document.getElementById('typingIndicator').classList.remove('active');
                    document.getElementById('typingIndicator3').classList.remove('active');
                }
            });
            
            socket.on('clue-result', (data) => {
                if (data.correct) {
                    handleCorrectClue(data.clueId);
                }
                showPopup(data.response);
            });
            
            socket.on('receive-gift', (data) => {
                showGift(data.gift, data.message);
            });
        }
        
        function updateConnectionStatus(isConnected) {
            const statusDiv = document.getElementById('connectionStatus');
            const statusText = document.getElementById('statusText');
            
            if (isConnected) {
                statusDiv.className = 'connection-status connected';
                statusText.innerText = 'Host Connected';
                connected = true;
            } else {
                statusDiv.className = 'connection-status disconnected';
                statusText.innerText = 'Host Disconnected';
                connected = false;
            }
        }
        
        function showHostMessage(message) {
            showPopup(message);
        }
        
        function displayHostResponse(response) {
            const responseDiv = document.getElementById('hostResponse');
            const answerDiv = document.getElementById('hostAnswer');
            
            if (document.getElementById('clue2').style.display === 'block') {
                responseDiv.style.display = 'block';
                responseDiv.innerHTML = `<strong>Host:</strong> "${response}"`;
            } else {
                answerDiv.style.display = 'block';
                answerDiv.innerHTML = `<strong>Host:</strong> "${response}"`;
            }
        }
        
        // Game state
        let currentClue = 1;
        let giftCount = 0;
        const gifts = ['üéÅ', 'üéâ', 'üèÜ', 'üíé', 'üîÆ', '‚≠ê', 'üåô', '‚ö°', 'üïØÔ∏è', 'üóùÔ∏è'];
        
        // Initialize socket on page load
        window.onload = function() {
            initSocket();
        };
        
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'jovia' && password === 'jovia256') {
                document.getElementById('loginPage').classList.remove('active');
                document.getElementById('loadingPage').classList.add('active');
                
                showPopup('Welcome Jovia to the game!');
                
                // Circular loading animation
                let progress = 0;
                const loadingInterval = setInterval(() => {
                    progress += 1;
                    document.getElementById('loaderProgress').innerText = progress + '%';
                    document.getElementById('loaderText').innerText = progress < 30 ? 'Initializing...' : 
                                                                    progress < 60 ? 'Loading truths...' : 
                                                                    progress < 90 ? 'Almost there...' : 'Ready';
                    
                    if (progress >= 100) {
                        clearInterval(loadingInterval);
                        setTimeout(() => {
                            document.getElementById('loadingPage').classList.remove('active');
                            document.getElementById('introPage').classList.add('active');
                        }, 500);
                    }
                }, 30);
            } else {
                document.getElementById('loginError').innerText = 'Access Denied. Invalid credentials.';
            }
        }
        
        function showPopup(message) {
            const popup = document.createElement('div');
            popup.className = 'popup';
            popup.innerText = message;
            document.body.appendChild(popup);
            
            setTimeout(() => {
                popup.remove();
            }, 3000);
        }
        
        function showGift(gift, message) {
            giftCount++;
            const giftDiv = document.createElement('div');
            giftDiv.className = 'gift-popup';
            giftDiv.innerHTML = `
                <span class="gift-close" onclick="this.parentElement.remove()">√ó</span>
                <div class="gift-icon">${gift || gifts[giftCount % gifts.length]}</div>
                <div class="gift-text">${message || 'You\'ve earned a gift!'}</div>
            `;
            document.body.appendChild(giftDiv);
            
            setTimeout(() => {
                if (giftDiv.parentElement) {
                    giftDiv.remove();
                }
            }, 4000);
        }
        
        function startFirstClue() {
            document.getElementById('introPage').classList.remove('active');
            document.getElementById('gamePage').classList.add('active');
            document.getElementById('clue1').style.display = 'block';
        }
        
        function checkAnswer1(answer) {
            if (!connected) {
                showPopup('Waiting for host connection...');
                return;
            }
            
            // Disable buttons to prevent double submission
            disableClue1Buttons(true);
            
            socket.emit('submit-clue-answer', {
                clueId: 1,
                answer: answer,
                sessionId: sessionId
            });
            
            if (answer === 'D') {
                setTimeout(() => {
                    handleCorrectClue(1);
                }, 1000);
            } else {
                showPopup('‚ùå Not quite. Listen to the question carefully...');
                disableClue1Buttons(false);
            }
        }
        
        function disableClue1Buttons(disabled) {
            document.getElementById('optA').disabled = disabled;
            document.getElementById('optB').disabled = disabled;
            document.getElementById('optC').disabled = disabled;
            document.getElementById('optD').disabled = disabled;
        }
        
        function handleCorrectClue(clueId) {
            if (clueId === 1) {
                document.getElementById('clue1').style.display = 'none';
                document.getElementById('clue2').style.display = 'block';
                showGift('üéÅ', 'First clue completed!');
                showPopup('‚ú® Correct! You found the first truth!');
                disableClue1Buttons(false);
            }
        }
        
        function checkAnswer2(answer) {
            if (!connected) {
                showPopup('Waiting for host connection...');
                return;
            }
            
            if (answer === 'C') {
                document.getElementById('customQuestion').style.display = 'block';
                document.getElementById('decodeSection').style.display = 'none';
            } else if (answer === 'A') {
                document.getElementById('customQuestion').style.display = 'none';
                document.getElementById('decodeSection').style.display = 'block';
            } else {
                showPopup('Try a different approach...');
            }
        }
        
        function askCustomQuestion() {
            if (!connected) {
                showPopup('Waiting for host connection...');
                return;
            }
            
            const question = document.getElementById('customQuestionInput').value;
            const expectedAnswer = document.getElementById('customAnswerInput').value.toLowerCase();
            
            if (question && expectedAnswer) {
                socket.emit('ask-question', {
                    question: question,
                    sessionId: sessionId
                });
                
                // Check if answer contains bonz
                if (expectedAnswer.includes('bonz')) {
                    setTimeout(() => {
                        showGift('üîÆ', 'You decoded the truth!');
                        document.getElementById('clue2').style.display = 'none';
                        document.getElementById('clue3').style.display = 'block';
                    }, 3000);
                }
            }
        }
        
        function decodeAnswer() {
            if (!connected) {
                showPopup('Waiting for host connection...');
                return;
            }
            
            const decodeInput = document.getElementById('decodeInput').value.toLowerCase();
            
            socket.emit('submit-clue-answer', {
                clueId: 2,
                answer: decodeInput,
                sessionId: sessionId
            });
            
            if (decodeInput === 'bonz') {
                setTimeout(() => {
                    showGift('üóùÔ∏è', 'Code cracked!');
                    document.getElementById('clue2').style.display = 'none';
                    document.getElementById('clue3').style.display = 'block';
                }, 1000);
            } else {
                showPopup('‚ùå Try reversing the word...');
            }
        }
        
        function askHostQuestion() {
            if (!connected) {
                showPopup('Waiting for host connection...');
                return;
            }
            
            const question = document.getElementById('guestQuestion').value;
            
            if (question) {
                document.getElementById('askHostBtn').disabled = true;
                
                socket.emit('ask-question', {
                    question: question,
                    sessionId: sessionId
                });
                
                setTimeout(() => {
                    document.getElementById('askHostBtn').disabled = false;
                }, 3000);
            }
        }
        
        function restartGame() {
            // Reset everything
            document.getElementById('gamePage').classList.remove('active');
            document.getElementById('introPage').classList.remove('active');
            document.getElementById('loadingPage').classList.remove('active');
            document.getElementById('loginPage').classList.add('active');
            
            // Reset forms
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('loginError').innerText = '';
            
            // Reset clues
            document.getElementById('clue1').style.display = 'block';
            document.getElementById('clue2').style.display = 'none';
            document.getElementById('clue3').style.display = 'none';
            document.getElementById('customQuestion').style.display = 'none';
            document.getElementById('decodeSection').style.display = 'none';
            document.getElementById('hostResponse').style.display = 'none';
            document.getElementById('hostAnswer').style.display = 'none';
            document.getElementById('guestQuestion').value = '';
            
            // Reset buttons
            disableClue1Buttons(false);
            
            currentClue = 1;
            giftCount = 0;
            
            // Generate new session
            sessionId = 'session_' + Date.now();
            localStorage.setItem('sessionId', sessionId);
            socket.emit('join-game', sessionId);
        }
    </script>
</body>
</html>